/*
 * lcd_5110.c
 *
 *  Created on: 2014-9-6
 *      Author: my
 */
#include "include.h"
unsigned char zifu[]=
{
		0x00,0x00,0x00,0x5F,0x55,0x55,0xF5,0x55,0x55,0x55,0x95,0x5F,0x00,0x00,0x00,0x00,
		0x11,0x11,0x09,0x09,0xFD,0x55,0x57,0x57,0x55,0x55,0x55,0xFD,0x01,0x01,0x01,0x00,

		0x00,0x04,0xFF,0x24,0x24,0x24,0xFF,0x04,0x00,0xFE,0x22,0x22,0x22,0xFE,0x00,0x00,
		0x88,0x48,0x2F,0x09,0x09,0x19,0xAF,0x48,0x30,0x0F,0x02,0x42,0x82,0x7F,0x00,0x00,

		0x00,0x00,0xF8,0x88,0x88,0x88,0x88,0xFF,0x88,0x88,0x88,0x88,0xF8,0x00,0x00,0x00,
		0x00,0x00,0x1F,0x08,0x08,0x08,0x08,0x7F,0x88,0x88,0x88,0x88,0x9F,0x80,0xF0,0x00,

		0x80,0x82,0x82,0x82,0x82,0x82,0x82,0xE2,0xA2,0x92,0x8A,0x86,0x82,0x80,0x80,0x00,
		0x00,0x00,0x00,0x00,0x00,0x40,0x80,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

		0x20,0x20,0x24,0xA4,0xAC,0xB4,0xA5,0xA6,0xA4,0xB4,0xAC,0xA4,0x24,0x20,0x20,0x00,
		0x80,0x80,0x40,0x47,0x24,0x1C,0x04,0x04,0x04,0x7C,0x84,0x87,0x80,0x80,0xE0,0x00,

		0x88,0x86,0xA2,0xAA,0xAA,0xFE,0xAA,0xAB,0xAA,0xFE,0xAA,0xAA,0xA2,0x8A,0x86,0x00,
		0x08,0x08,0x04,0x82,0xBF,0x42,0x22,0x1E,0x22,0x42,0xBF,0x02,0x04,0x08,0x08,0x00,
};

const unsigned char font6x8[][6] =
{
    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
    { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
    { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
    { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
    { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
    { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
    { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
    { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
    { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
    { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
    { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
    { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
    { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
    { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
    { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
    { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
    { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
    { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
    { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
    { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
    { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
    { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
    { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
    { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
    { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
    { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
    { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
    { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
    { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
    { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
    { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
    { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
    { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
    { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
    { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
    { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
    { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
    { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
    { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
    { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
    { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
    { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
    { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
    { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
    { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
    { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
    { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
    { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
    { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
    { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
    { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
    { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
    { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
    { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
    { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
    { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
    { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
    { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
    { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
    { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
    { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
    { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
    { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
    { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
    { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
    { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
    { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
    { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
    { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
    { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
    { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
    { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
    { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
    { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
    { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
    { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
    { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
    { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
    { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
    { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
    { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
    { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};

uchar picture[][40] = {
		0xE0,0x1C,0x06,0x01,0x01,0x03,0x02,0x02,0x84,0x04,0x08,0x10,0x30,0x20,0xC0,0x80,
		0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x70,0x18,0x04,0x84,0x86,0x42,0xC2,0x42,0x82,
		0xC2,0x82,0x84,0x0C,0x08,0x30,0xC0,0x00,0xF5,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0xEB,0xD8,0x60,0x60,0x10,0x18,0x18,0x05,0x0D,0x06,0x04,0x06,0x02,0x06,0x83,0x46,
		0x84,0x86,0x0D,0x09,0x0C,0x18,0x38,0x28,0x50,0xD3,0xAA,0x3F,0x3C,0xB0,0x02,0xFD,
		0x03,0x06,0x0C,0x08,0x08,0xEC,0x3C,0x07,0x03,0x01,0x00,0x00,0x38,0x6C,0xE4,0x7C,
		0x70,0x00,0x00,0xE0,0xE0,0xE2,0xC7,0x0E,0x0E,0x0F,0x00,0x00,0xC0,0x70,0x00,0x00,
		0x00,0x00,0x02,0x01,0x03,0x04,0xAB,0xFF,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x40,
		0x00,0x00,0x00,0x08,0x10,0x10,0x10,0x30,0x30,0x70,0x70,0xF0,0xF3,0xFB,0x8D,0x04,
		0x84,0x8C,0xFE,0xFF,0xDF,0x01,0x00,0x00,0x00,0x80,0xC0,0xE0,0xB0,0x1A,0x06,0x01,
		0x00,0x00,0x00,0x02,0x07,0x0D,0x09,0x14,0x10,0x28,0x30,0x20,0x20,0x20,0x20,0x20,
		0x20,0x20,0x20,0x60,0xA1,0xA3,0x97,0x97,0xFF,0xBD,0x8D,0x8F,0x87,0x84,0x82,0x41,
		0x41,0x40,0x20,0xE0,0x80,0x81,0x86,0xFC,

};
void delaylcd(unsigned int ms)//1ms延时函数
{
	unsigned int i,x;
	for(x=0;x<ms;x++)
	{
		for(i=0;i<10;i++);
	}
}

/***********************************************
 * 函数：write_com(uchar com)
 * 作用：写入命令或数据
 * 备注：
***********************************************/
void LCD_DC(unsigned char dt, unsigned char command)//写指令0写数据1   dt:写的内容；
{
	unsigned char i;
	CE_L;			     //5110使能
	if (command == 0)    //写命令
        {
          DC_L;
        }    //串口关使能
	else
        {
         DC_H;
        }    //写数据，串口使能
	for(i=0;i<8;i++)//8位数据
	{
		if(dt&0x80) //写入的东西从高位开始读
                {
		DIN_H;
                }//串口使能
		else
                {
                DIN_L;
                }
		CLK_L; 	//CP0
		dt=dt<<1;	//让指令依次左移使之读出
		CLK_H; 	//CP1
	}
	CE_H;	//关使能
}
/**********************************************
 * 函数：set_pos(uchar x, uchar y)
 * 作用：设置显示初始坐标
 * 备注
 **********************************************/
void set_pos(uchar x, uchar y)
{
	LCD_DC(0x40|y, 0);// column		0100 0000	0写指令	0x40|Y指令集中设置行地址的指令,Y:0~5
	LCD_DC(0x80|x, 0);// row		1000 0000	0写指令	0x80|X指令集中设置列地址的指令,X:0~83
}

/**************************************************
 * 函数：LCD_clear(void)
 * 作用：清屏
 * 备注：
 *************************************************/
void LCD_clear(void)
{
	unsigned char t;
	unsigned char k;
	LCD_DC(0x0c,0);
    LCD_DC(0x80,0);//设置首地址
	for(t=0;t<6;t++)//行
	{
		for(k=0;k<84;k++)//列
		{
			LCD_DC(0x00,1);		//写数据 0x00 清空

		}
	}
}

/****************************************************
 * 函数：LCD_INIT(void)
 * 初始化液晶
 * 备注：
 ***************************************************/
void LCD_INIT(void)
{
    P6DIR |= BIT1+BIT2+BIT3+BIT4;
    P7DIR |= BIT0;
	REST_L;  	//0 使复位
  	delaylcd(1);
  	REST_H;  	//关复位
	CE_L;
	delaylcd(1);
	CE_H;
	delaylcd(1);
	LCD_DC(0x21,0);//初始化Lcd,功能设定使用扩充指令		0写指令
	LCD_DC(0xC8,0);//设定液晶偏置电压					0写指令
	LCD_DC(0x06,0);//温度校正							0写指令
    LCD_DC(0x13,0);//设置偏置系统(BSx) 1:48,设置为0x10~0x17 							0写指令
	LCD_DC(0x20,0);//使用基本指令，V=0，水平寻址			0写指令
    LCD_clear();
	LCD_DC(0x0C,0);//设定显示模式，正常显示				0写指令
	CE_L;
	delaylcd(200);
}

/******************************************************
 * 函数：display_char(uchar x, uchar y,uchar c)
 * 作用：显示6x8的英文字符
 * 备注：
 *******************************************************/
void display_char6x8(uchar x, uchar y,uchar c)
{
	uchar line;

	 c -= 32;
	 set_pos(x*6,y);
	 for(line=0;line<6;line++)
	 {
		 LCD_DC(font6x8[c][line],1);
	 }
}

/******************************************************
 * 函数：display_str(uchar x, uchar y, uchar *str)
 * 作用：特定位置输出字符串
 * 备注：
 ******************************************************/
void display_str6x8(uchar x, uchar y, uchar *str)
{
	while(*str != '\0')
	{
		display_char6x8(x,y,*str++);
		x++;
		if(x == 15)
		{
			x = 0;
			y++;
		}
		if(y==6)
		{
			y = 0;
		}

	}

}

/******************************************************
 * 函数：display_chinese
 * 作用：显示单个汉字
 * 备注：
 ******************************************************/
void display_chinese(unsigned char row, unsigned char page,unsigned char *c) //row:列 page:页 dd:字符
{
	unsigned char i;

	set_pos(row*16, page*2);  //写数据 第一行起始地址设定，由于每个字符大小是6*12,占用两行
	for(i=0; i<16;i++)
          LCD_DC(c[i],1);//c代表在zifu数组中的位置

  	set_pos(row*16, page*2+1);//写数据 第二行起始地址设定
	for(i=16; i<32;i++)
          LCD_DC(c[i],1);
}
/********************************************************
 * 函数：display_chinese_str
 * 作用：显示多个汉字
 * 备注：每行最多显示5个汉字
 ********************************************************/
void display_chinese_str(uchar x, uchar y,uchar n, uchar *str)
{
	uchar i;
	for(i=0;i<n;i++)
	{
		display_chinese(x++,y,str+i*32);
		if( i == 4)
		{
			x = 0;
			y++;
		}
	}
}
/****************************************************
 * 函数：display_picture(x,y)
 * 功能：显示自定义图片
 * 备注：
 *****************************************************/
void display_picture(uchar x, uchar y, uchar lon,uchar high)
{
	uchar i,j;

	for(j=0;j<high;j++)
	{
		set_pos(x,y);
		for(i=0;i<lon;i++)
			{
				LCD_DC(picture[j][i],1);
			}
		y++;
	}

}
